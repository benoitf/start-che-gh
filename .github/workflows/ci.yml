name: che-install

on: [push]

jobs:
  example:
    name: setup che
    runs-on: ubuntu-18.04
    steps:
      - name: Checkout
        uses: actions/checkout@v1
      - name: Setup Minikube
        uses: manusa/actions-setup-minikube@v2.0.0
        with:
          minikube version: 'v1.11.0'
          kubernetes version: 'v1.18.2'
          github token: ${{ secrets.GITHUB_TOKEN }}
      - name: Check
        run: |
          kubectl get nodes
          #echo "stopping minikube"
          #sudo -E minikube stop
          echo "install minikube addon"
          sudo -E minikube addons enable ingress
          #sudo -E minikube start
          echo "download chectl"
          bash <(curl -sL  https://www.eclipse.org/che/chectl/)
          echo "start chectl"
          chectl server:start --platform=minikube --installer=helm
          
